apiVersion: apiextensions.crossplane.io/v1
kind: CompositeResourceDefinition
metadata:
  name: xgitops.irizzant.it
spec:
  group: irizzant.it
  names:
    kind: XGitOps
    plural: xgitops
  claimNames:
    kind: GitOps
    plural: gitops
  versions:
  - name: v1alpha1
    served: true
    referenceable: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              id:
                type: string
                description: Identifier of this GitOps
              kubeConfig:
                type: object
                properties:
                  secretName:
                    description: The name of the secret with KubeConfig
                    type: string
                  secretNamespace:
                    description: The Namespace with the secret with KubeConfig
                    type: string
                    default: crossplane-system
                  secretKey:
                    description: The key that contains kubeconfig
                    type: string
                    default: kubeconfig
                required:
                - secretName
              gitOpsRepo:
                type: string
                description: GitOps repo URL
              gitOpsPath:
                type: string
                description: GitOps repo path
              gitOpsSecret:
                type: string
                description: Name of the secret in the host cluster to replicate in the VCluster. Can be used to configure a ClusterStore for external-secrets
            required:
            - id
            - kubeConfig
            - gitOpsRepo
            - gitOpsPath
            - gitOpsSecret